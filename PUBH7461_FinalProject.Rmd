---
title: "PUBH 7461 Final Project"
author: "Vamsi"
date: "2024-12-04"
output: html_document
---

```{r}
data<-read.csv("C:/UMN/fall2024/ExpVis data in R/project/US-National-Parks_Use_1979-2023_By-Month.csv")
```
###Dataset

```{r warnings=FALSE}
library(dplyr)
library(ggplot2)
library(gt)
library(scales)
library(tidyr)
```
###Question 1:What is the  Distribution of the types of visits to National Parks across the years?

```{r}
data %>% 
  group_by(Year) %>%
  summarise(
    TotalRecreationVisits = sum(RecreationVisits),
    TotalNonRecreationVisits = sum(NonRecreationVisits),
    TotalTentCampers = sum(TentCampers),
    TotalRVCampers = sum(RVCampers),
    TotalBackcountry = sum(Backcountry)
  ) %>%
  pivot_longer(cols = -Year, 
               names_to = "Category", 
               values_to = "Count") %>% 
  ggplot(aes(x=Count,y=Category))+
  geom_boxplot()+
  geom_jitter(alpha=0.3,aes(color=Category))+
  scale_x_continuous(labels=label_comma())+
  labs(x="Number of Visits ",y="Type of Visit",title="Distribution of visits to US National Parks across the years")+
  theme_classic()+
  theme(legend.position = "none")

```
### Question 2: How have recreation and non-recreation visits to US National Parks evolved over the years?

```{r}
data %>%
 group_by(Year) %>%
  summarise(
    TotalRecreationVisits = sum(RecreationVisits),
    TotalNonRecreationVisits = sum(NonRecreationVisits)) %>%
  ggplot(aes(x = Year)) +
  geom_line(aes(y = TotalRecreationVisits, color = "Recreation Visits")) +
  geom_line(aes(y = TotalNonRecreationVisits, color = "Non-Recreation Visits")) +
  labs(
      title = "US National Park Visits Over The Years - Recreational vs Non-Recreational",
      x = "Year", y = "Number of Visits",
      color = "Visit Type"
      ) +
  scale_y_continuous(labels = label_comma()) +
  theme_bw()
```
###Question 3:What is the monthwide trend in recreation visits across regions during 2019,2020,2021?


```{r}
data %>% 
  filter(Year %in% c("2019","2020","2021")) %>% 
  group_by(Region,Month,Year) %>% 
  summarise(TotalRecVis=sum(RecreationVisits),
            TotalNonRecVis=sum(NonRecreationVisits)) %>% 
  ggplot(aes(x=Month,y=TotalRecVis)) +
  geom_line(aes(color=factor(Year))) +
  facet_wrap(~Region)+
  scale_y_continuous(labels = label_comma()) +
  scale_x_continuous(breaks=1:12,labels=month.abb)+
   theme_bw()+
  theme(axis.text.x= element_text(angle=45,hjust=1))+
  labs(y="Number of Recreation Visits",
       color="Year",
       title="Monthwise comparision of Recreation Visits by Region",
       subtitle = "Observing the impact of COVID")
 
```


###Question 4 : How do the number of visits look like across different parks in the Intermountain region during 2019-2021?

```{r}
data %>% 
  filter(Year %in% c("2019","2020","2021")) %>% 
  filter(Region=="Intermountain ") %>% 
  group_by(ParkName,Year) %>% 
  summarise(TotalRecVis=sum(RecreationVisits),
            TotalNonRecVis=sum(NonRecreationVisits)) %>% 
  pivot_wider(names_from=Year,values_from=c(TotalRecVis,TotalNonRecVis)) %>% 
  ungroup() %>% 
  mutate(row_number=row_number()) %>% 
  select(row_number,ParkName,TotalRecVis_2019,TotalRecVis_2020,TotalRecVis_2021,TotalNonRecVis_2019,TotalNonRecVis_2020,TotalNonRecVis_2021) %>% 
  gt() %>% 
  tab_spanner(label="Recreation Visits",columns=starts_with("TotalRecVis")) %>% 
  tab_spanner(label="Non Recreation Visits",columns=starts_with("TotalNonRecVis")) %>% 
  cols_label(row_number="",ParkName="National Park",TotalRecVis_2019="2019",TotalRecVis_2020="2020",TotalRecVis_2021="2021",TotalNonRecVis_2019="2019",TotalNonRecVis_2020="2020",TotalNonRecVis_2021="2021") %>% 
  tab_header(title="Number of Visits to National Parks in Intermountain Region during 2019-2021") %>% 
  tab_source_note(source_note = "Data source: U.S. NATIONAL PARK VISIT DATA(1979-2023)")
```





